import mysql.connector

conn = mysql.connector.connect(user='root', password='Passw0rd!', host='192.168.2.140', database='kerberos')
cur = conn.cursor()

def checkticket(ip_src, cipher, msg_type, timestamp):
    global cur

    query = 'SELECT * from cipher_table WHERE msg_type = %s'
    cur.execute(query, (int(12),))
    curfet = cur.fetchall()
    for res in curfet:
        print(res[2])


ip_src = '10.0.9.125'
msg_type = 12
cipher = '9e:a7:e4:c5:bb:1a:2d:bf:b2:0a:8f:8e:02:2e:50:ea:38:10:ea:f5:41:e7:96:d9:2c:4e:29:e5:07:24:7a:61:31:7a:5f:c6:b0:77:28:6f:a3:9b:55:f2:54:44:b5:ff:24:28:96:4e:5c:d0:9d:b9:e9:4a:dd:5b:76:89:dc:93:d4:21:c1:73:32:77:a6:05:13:18:7c:8a:41:9d:de:cd:a8:10:55:0d:1f:1e:76:e8:18:63:cf:a8:b1:e1:eb:23:1b:b0:b9:55:26:ed:16:b4:f2:09:8f:e2:fb:42:c2:6a:36:f6:bd:af:7a:2e:5e:89:25:ec:a4:03:5d:7f:f4:b3:a3:4a:5c:5d:a4:15:57:64:a4:97:3c:d1:fc:08:1d:ed:64:56:5d:7e:74:d3:b3:48:22:34:9c:17:54:c9:01:d9:3c:d0:79:e5:ad:e1:f3:41:da:37:7e:36:18:93:8e:73:98:a7:43:14:8f:62:e9:fe:1f:f0:80:d8:98:c3:b4:29:0a:a6:9a:f0:77:9a:37:0e:55:b3:7c:9f:7a:0f:a3:14:06:b3:35:bc:a4:09:8d:7e:27:60:3a:86:6a:0f:29:a0:83:30:3a:e8:89:21:36:84:14:b6:f8:df:18:23:e7:84:0d:3b:c6:a8:47:b8:43:93:be:b5:8f:58:f0:d2:b7:0a:0c:7e:20:8a:ff:d1:13:38:40:6a:99:32:c2:ff:45:bb:e9:80:02:70:5e:ae:02:bf:0e:16:aa:ea:ea:55:5e:77:6e:78:00:ba:fd:3f:e7:54:58:b8:61:2b:d1:c0:6d:8f:3a:ee:63:3a:02:fe:ba:ff:70:8e:40:a1:14:f0:6c:c4:73:08:28:63:f5:3e:b1:68:ef:55:13:4a:b6:31:2a:f5:98:8d:e8:d2:23:16:57:7e:9e:1f:4e:41:17:a6:5c:39:e7:89:07:1c:aa:cf:1a:10:c1:cb:ea:bd:0e:d3:c6:27:a6:7a:97:f2:43:00:86:6d:2b:85:1b:4e:bd:c5:6b:e2:55:0f:c0:4e:7b:80:5b:53:32:75:5b:df:a7:f3:7e:6c:de:6b:0b:9c:02:c4:07:35:17:2c:6e:f6:49:ff:c4:f6:2d:cd:8e:52:fa:7c:7a:78:b1:fe:93:fc:37:18:7e:35:ef:4f:57:c9:0c:2d:61:a2:31:7b:ed:05:b8:6f:6c:95:96:1d:bc:6d:06:ec:0d:0d:0c:c8:d6:10:db:ad:f8:ad:4b:00:f7:74:1d:f6:15:28:30:7e:ed:22:3f:4a:f7:1d:87:6c:b9:cb:3b:7e:79:9e:0b:9f:eb:dc:95:f2:de:36:f6:7f:97:aa:a3:94:b4:b4:14:86:1a:79:f1:a8:9d:52:5e:9a:92:6e:2d:c4:8c:fe:d1:55:b0:8d:02:40:53:04:eb:56:b9:f9:84:b0:ad:66:ce:19:03:15:5e:b2:f2:2e:40:40:50:90:6b:5a:05:8f:34:7c:84:17:b6:67:2f:ef:8c:0d:2a:bf:b8:a0:ee:59:c6:6a:e3:40:5c:bd:15:ca:cb:86:27:28:7f:a7:e7:dd:09:03:47:c8:62:ca:69:96:d3:bb:68:98:f6:42:bf:6b:e6:e3:40:4e:1b:0b:65:e0:b2:58:a6:fa:4b:99:12:d1:f5:af:ba:e2:84:a4:70:ec:40:b2:cb:f5:9e:d4:37:9b:bd:19:28:ee:da:37:03:35:72:0a:e8:a5:1e:11:77:99:9f:e4:91:1d:22:8c:89:c5:ac:31:11:c5:48:05:57:39:66:1d:38:48:f8:f9:b8:4a:81:f4:f5:0c:a8:5c:87:7f:ce:d2:d5:e8:c2:03:41:5d:56:40:93:2f:d3:7f:86:95:2b:e5:e5:94:e7:f1:d2:1f:11:84:66:11:66:ca:d8:bc:7a:40:1a:45:ea:a9:3f:48:c2:c8:07:01:58:26:68:0b:2f:26:86:ad:40:14:8f:2e:0c:9a:37:44:34:45:c8:3a:97:99:08:a2:26:7f:22:4e:90:35:f1:b6:31:7f:40:6e:fd:bd:e6:26:7d:9f:9e:8a:44:98:05:37:98:56:68:ed:49:36:e8:8d:7b:26:75:40:3f:35:0e:88:55:95:40:57:b3:f1:5f:f0:10:de:7b:3c:52:bf:d3:17:24:44:ee:d6:68:9a:fc:84:6c:a6:27:a2:c2:38:15:6a:cc:fa:a7:24:65:7b:97:48:07:f8:3e:24:11:da:08:40:5d:8e:64:b6:de:37:14:13:f6:00:eb:e9:da:61:9e:12:60:8d:86:58:61:57:c9:51:6f:e8:03:ff:ac:01:7b:bf:b2:1e:84:6e:44:48:4f:93:72:18:71:34:43:90:9d:19:d8:29:5a:b2:64:33:6f:36:f1:8a:7e:30:b6:19:22:5b:3b:01:f2:4e:1f:1c:1a:a7:80:77:e0:87:b1:d2:04:5f:65:38:34:94:02:79:20:4e:ce:a5:50:92:2c:eb:45:2b:4c:93:c3:65:0f:5a:f2:1d:0f:7b:70:23:bd:c0:23:e8:e2:82:f3:62:89:f2:70:e0:5e:4a:77:b9:dd:88:46:9e:88:6a:0f:5c:12:11:05:d8:b9:d0:e2:92:31:e2:b1:e5:17:c5:6b:85:f3:47:8a:9a:45:4d:ef:5f:02:8c:6e:b3:a3:fa:fd:a4:91:4a:df:20:3d:ec:33:13:71:5d:49:98:a4:72:92:5d:52:fd:1f:90:aa:55:c3:07:0c:ef:cb:c6:7e:62:cf:0d:e8:20:0b:1e:43:68:5e:a6:fd:92:e8:b8:f6:ba:bb:55:73:f3:c7:88:ef:d7:e9:20:db:e3:15:ca:a8:9a:23:91:b2:03:0b:f5:bc:19:68:0c:f5:b8:84:9c:1a:c0:c6:b0:e1:92:81:60:9b:77:a8:87:a3:f2:51:f7:86:3d:3f:3b:23:ce:0e:55:06:ad:ae:68:78:0d:02:b3:2f:f4:90:1e:e2:60:67:9d:97:1d:72:23:5b:8e:4b:af:44:2a:6a:d1:9c:58:45:d1:51'
timestamp = 1556237153816
checkticket(ip_src, cipher, msg_type, timestamp)

